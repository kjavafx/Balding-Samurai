<?xml version="1.0"?>
<account version="1.45" name="BasicRSI_Optimize" startingcash="150000" ACB="10000" MV="0" equityvalue="0" barsback="45" lastdate="200308011143120" fromdate="201404011143120" todate="201405212359000" buyfixedcost="0" sellfixedcost="0" buypercost="0" sellpercost="0" buyslip="0" sellslip="0" slippagemodel="0" slippagesymbol="0" uniquenum="2" pyramiding="0" shortsell="0" negitivebalance="0" basecurrency="USD" deployobjectid="2" deployignoredataerror="0"><note>A Basic RSI system

Rules:
Buy when the RSI moves up through 30
Sell when the RSI moves down through 70

We have to define two variables to record the fact that the upper and lower
RSI bands have been breached. Once they have been breached, we enter/exit
when RSI moves back through the band.</note><variables/>
<events><event name="Begin"></event><event name="End"></event></events><orders/>
<systems><system name="BasicRSI" heartbeat="OneMinute" usetimeperiods="FiveMinutes" usesymbols="" multipleorders="1" implicittif="0" implicitoca="0" deployobjectid="2">
<note></note><variables><variable name="TriggerUpper" default="81" scope="1" value="" optimise="1" optistart="70" optifinish="100" optistep="5"><instance symbol="MSFT" value="0"/>
</variable><variable name="TriggerLower" default="15" scope="1" value="" optimise="1" optistart="0" optifinish="30" optistep="5"><instance symbol="MSFT" value="0"/>
</variable><variable name="rsilower" default="14" scope="1" value="" optimise="1" optistart="5" optifinish="20" optistep="4"/>
<variable name="rsiupper" default="14" scope="1" value="" optimise="1" optistart="5" optifinish="20" optistep="4"/>
</variables><events><event name="Begin">
R '
	library(ggplot2);
	library(data.table);
	library(LoopAnalyst);
';</event><event name="Bar">#Basic RSI system
#Buy when the RSI moves up through 30
#Sell when the RSI moves down through 70
#We have to define two variables to record the fact that the upper and lower
#RSI bands have been breached. Once they have been breached, we enter/exit
#when RSI moves back through the band.
RVar(Open);
RVar(Close);

R '
	diff &lt;- data.table(Close-Open);
	plot(ggplot(diff, aes(x=V1)) + geom_histogram());

	m &lt;- mean(diff$V1);
';

my $m = RVar('m');
Output('$m');

#Define the RSI bands - narrowing the bands will increase trades
my $upper=70;
my $lower=30;

#Set the triggers for the bands.
$TriggerLower=1 if Today(RSI($rsilower))&lt;$lower;
$TriggerUpper=1 if Today(RSI($rsiupper))&gt;$upper;

if (not Position) {
  #We do not have a position - has the trigger fired?
  if ($TriggerLower) {
    if (Today(RSI($rsilower))&gt;$lower) {
      #The RSI has passed up through the lower band, go long.
      BuyOpen;
      #reset the triggers
      $TriggerLower=0;
      $TriggerUpper=0;
    } 
  }
}
else {
  #We have a position - has the trigger fired?
  if ($TriggerUpper) {
    if (Today(RSI($rsiupper))&lt;$upper) {
      #The RSI has passed down through the upper band, close the long.
      SellOpen;
      #reset the triggers
      $TriggerLower=0;
      $TriggerUpper=0;
    } 
  }
}
</event><event name="OrderFill"></event><event name="End"></event></events><moneymanagement name="FixedUnits">
<note>Description

This money management object will always trade 100000

Orders available:

BuyOpen, BuyStop, SellOpen and SellStop

Misc:

A stop price needs to be passed into the BuyStop and SellStop.

This MM will short and will pyramid if account options set.
</note><variables/>
<mmfunction name="positionsize">#How many units to trade?

return 100000;</mmfunction><events>
<event name="BuyMarket">if (ShortPosition) {
  #If we have a short position, close it.
  PlaceBuyOpen('fixedcash');
}
else {
  #we have no position, or we are long.
  my $num=PositionSize();
  PlaceBuyOpen('fixedcash',$num) if $num;
}

</event><event name="SellMarket">if (LongPosition) {
  #If we have a long position, close it.
  PlaceSellOpen('fixedcash');
}
else {
  #If we have no position or we are short, place the order
  my $num=PositionSize();
  PlaceSellOpen('fixedcash',$num) if $num;
}
</event><event name="BuyStop">my $stop=shift;
#Stop trading if we do not have a stop price
die 'No stop price for BuyStop' unless $stop;

if (ShortPosition) {
  #If we have a short position, close it.
  PlaceBuyStop('fixedcash',0,$stop);
}
else {
  #we have no position, or we are long.
  my $num=PositionSize();
  PlaceBuyStop('fixedcash',$num,$stop) if $num;
}
</event><event name="SellStop">my $stop=shift;
#Stop trading if we do not have a stop price
die 'No stop price for BuyStop' unless $stop;

if (LongPosition) {
  #If we have a long position, close it.
  PlaceSellStop('fixedcash',0,$stop);
}
else {
  #If we have no position or we are short, place the order
  my $num=PositionSize();
  PlaceSellStop('fixedcash',$num,$stop) if $num;
}</event><event name="BuyLimit"></event><event name="SellLimit"></event><event name="BuyStopLimit"></event><event name="SellStopLimit"></event><event name="StopLoss">die 'This money managment contains no logic for StopLoss';</event></events></moneymanagement><portfolio name="Portfolio" usedatastoresymbols="0">EURUSD</portfolio></system></systems><functions/>
</account>
